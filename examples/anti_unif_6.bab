(let s1 (+ (move 4 4 (scale 2 line)) (+ (move 3 2 line) (+ (move 4 3 (scale 9 circle)) (move 5 2 line))))
  (let s2 (+ (move 4 4 (scale 2 circle)) (+ (move 3 2 circle) (+ (move 4 3 (scale 9 circle)) (move 5 2 circle))))
    (+ s1 s2)))

-- This test mirrors the example in the smiley paper.

-- Expected:
(let f (fn s (+ (move 4 4 (scale 2 s)) (+ (move 3 2 s) (+ (move 4 3 (scale 9 circle)) (move 5 2 s)))))
  (let s1 (app f line)
    (let s2 (app f circle)
      (+ s1 s2))))